var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},ViewModels;(function(n){var t=function(t){function i(i,r,u,f){var e=this;t.call(this,i),this.UsualFTE=ko.observable(0),this.ContractedHoursPerWeek=ko.observable(0),this.MaxContractedHours=ko.observable(0),this.UsualFTE.subscribe(this.cb_CalculateContractedHoursPerWeek),this.ContractedHoursPerWeek.subscribe(this.cb_CalculateContractedHoursPerWeek),this.IsResource=r,this.AddCommentUri=u,this.Countries=ko.observableArray(),this.Sites=ko.observableArray(),this.DomicileCountrySiteList=ko.observableArray(),this.WorkLocationCountrySiteList=ko.observableArray(),this.DomicileCountry=ko.observable(""),this.DomicileSite=ko.observable(""),this.WorkLocationCountry=ko.observable(""),this.WorkLocationSite=ko.observable(""),this.RecoveryMethod=ko.observable(""),this.PercentageChargeability=ko.observable(0),this.IsSAPResource=ko.observable(!1),this.SupplierCategory=ko.observable(""),this.ServiceType=ko.observable(""),this.ServiceTypeEnabled=ko.observable(!1),this.ResourceType=ko.observable(""),this.Seconded=ko.observable(""),this.SelectedOrgUnit=ko.observable(""),this.SelectedOrgUnitId=ko.observable(),this.NewComment=ko.observable(""),this.CanEditResourceFields=ko.computed(function(){return!e.IsSAPResource()&&e.IsResource}),this.IsLoadingComment=ko.observable(!1),this.CanAddComment=ko.computed(function(){return e.NewComment().length==0?!1:e.IsLoadingComment()==!0?!1:!0}),this.DomicileCountry.subscribe(function(n){e.ChangeSiteList(n,e.DomicileCountrySiteList),(e.WorkLocationCountry()==""||e.WorkLocationCountry()==null)&&e.WorkLocationCountry(n)}),this.DomicileSite.subscribe(function(n){e.DomicileCountry()==e.WorkLocationCountry()&&(e.WorkLocationSite()==""||e.WorkLocationSite()==null)&&e.WorkLocationSite(n)}),this.WorkLocationCountry.subscribe(function(n){e.ChangeSiteList(n,e.WorkLocationCountrySiteList)}),this.IsPermanent=ko.computed(function(){return e.ResourceType()=="Permanent"?!0:!1}),this.PercentageChargeability.subscribe(function(){var n=e.PercentageChargeability();n<50?e.RecoveryMethod("Run"):function(){return 50}?e.RecoveryMethod("Charge"):e.RecoveryMethod("")}),this.SupplierCategory.subscribe(function(n){e.Seconded("Non-seconded");switch(n){case"Permanent/Regular":e.ServiceType(""),e.ServiceTypeEnabled(!1),e.ResourceType("Permanent");break;case"Inbound":case"Outbound":case"Third Country":e.Seconded("Seconded"),e.ServiceType(""),e.ServiceTypeEnabled(!1),e.ResourceType("Permanent");break;case"Apprentice":e.ServiceType("Apprentice"),e.ServiceTypeEnabled(!1),e.ResourceType("Apprentice");break;case"Graduate":e.ServiceType(""),e.ServiceTypeEnabled(!1),e.ResourceType("Graduate");break;case"Temp/Contractor Payr":case"On Call Contract":e.ServiceType(""),e.ServiceTypeEnabled(!1),e.ResourceType("Fixed Term Contract (Fixed Perm)");break;case"Intern":e.ServiceType(""),e.ServiceTypeEnabled(!1),e.ResourceType("Intern");break;case"Contingent WF":e.ServiceType(""),e.ServiceTypeEnabled(!1),e.ResourceType("Contingent Worker");break;case"Managed Services":e.ServiceType(""),e.ServiceTypeEnabled(!0);break;case"Consultant":e.ServiceType(""),e.ServiceTypeEnabled(!1),e.ResourceType("Consultant")}e.ServiceType.subscribe(function(n){switch(n){case"SI Partner":e.ResourceType("SI Partner");break;case"Fixed Price Engagement":e.ResourceType("Fixed Price Engagement");break;case"Outsourced (Managed Service)":e.ResourceType("Outsourced (Managed Service)")}})}),this.SelectElement=$("#SelectLineManager")[0],this.LineManagerViewModel=ko.observable(new n.LineManagerViewModel(f,this.SelectElement)),this.LineManagerViewModel().OnSelect=this.cb_Search}return __extends(i,t),i.prototype.ChangeSiteList=function(n,t){var i=Enumerable.From(this.Countries()).FirstOrDefault(null,function(t){return t.LookupValue==n}),r;i&&(r=Enumerable.From(this.Sites()).Where(function(n){return n.DependentLookupId==i.LookupId}).ToArray(),t(r))},i.prototype.Populate=function(n){var t=$.parseJSON(n);this.Countries(t.Countries),this.Sites(t.Sites)},i.prototype.cb_AddComment=function(){this.AddComment()},i.prototype.AddComment=function(){var n=this;this.IsLoadingComment(!0),$.ajax({type:"POST",url:this.AddCommentUri,data:{vacancyId:this.VacancyId,comment:this.NewComment()},dataType:"JSON",success:function(t){$(".jsonComment").empty(),$.each(t.Comments,function(n,t){var i=t;$(".jsonComment").append($("<tr><td>"+i.User+"<\/td><td>"+moment(i.Date).format("DD/MM/YYYY HH:mm:ss")+"<\/td><td>"+i.Comment+"<\/td><\/tr>"))}),n.ClearComment(),n.IsLoadingComment(!1)}})},i.prototype.OnOrgUnitSelected=function(n){this.SelectedOrgUnitId(n.EntityId),this.SelectedOrgUnit(n.Name)},i.prototype.cb_OnOrgUnitSelected=function(n){this.OnOrgUnitSelected(n)},i.prototype.ClearComment=function(){this.NewComment("")},i.prototype.cb_ClearComment=function(){this.ClearComment()},i.prototype.ShowLineManagers=function(){$(this.SelectElement).modal().css({width:"auto","margin-left":function(){return-($(this).width()/2)}})},i.prototype.cb_ShowLineManagers=function(){this.ShowLineManagers()},i.prototype.CalculateContractedHoursPerWeek=function(){this.UsualFTE()!=0?this.MaxContractedHours(this.ContractedHoursPerWeek()/this.UsualFTE()):this.MaxContractedHours(0)},i.prototype.cb_CalculateContractedHoursPerWeek=function(){this.CalculateContractedHoursPerWeek()},i}(n.SearchViewModel);n.UpdateRecordViewModel=t})(ViewModels||(ViewModels={}))